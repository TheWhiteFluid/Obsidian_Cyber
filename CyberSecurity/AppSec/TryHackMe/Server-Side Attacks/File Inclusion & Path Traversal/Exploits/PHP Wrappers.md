PHP wrappers are part of PHP's functionality that allows users access to various data streams. Wrappers can also access or execute code through built-in PHP protocols, which may lead to significant security risks if not properly handled.

For instance, an application vulnerable to LFI might include files based on a user-supplied input without sufficient validation. In such cases, attackers can use the `php://filter` filter. This filter allows a user to perform basic modification operations on the data before it's read or written. For example, if an attacker wants to encode the contents of an included file like `/etc/passwd` in base64. This can be achieved by using the `convert.base64-encode` conversion filter of the wrapper. 

The final payload will then be `php://filter/convert.base64-encode/resource=/etc/passwd`
	![](Pasted%20image%2020250122024422.png)

Once the application processes this payload, the server will return an encoded content of the **passwd** file.
	![](Pasted%20image%2020250122024433.png)
Which the attacker can then decode to reveal the contents of the target file.
	![](Pasted%20image%2020250122024513.png)
There are many categories of filters in PHP. Some of these are String Filters (string.rot13, string.toupper, string.tolower, and string.strip_tags), Conversion Filters (convert.base64-encode, convert.base64-decode, convert.quoted-printable-encode, and convert.quoted-printable-decode), Compression Filters (zlib.deflate and zlib.inflate), and Encryption Filters (mcrypt, and mdecrypt) which is now deprecated.

For example, the table below represents the output of the target file **.htaccess** using the different string filters in PHP.

|   |   |
|---|---|
|**Payload**|**Output**|
|php://filter/convert.base64-encode/resource=.htaccess|UmV3cml0ZUVuZ2luZSBvbgpPcHRpb25zIC1JbmRleGVz|
|php://filter/string.rot13/resource=.htaccess|ErjevgrRatvar ba Bcgvbaf -Vaqrkrf|
|php://filter/string.toupper/resource=.htaccess|REWRITEENGINE ON OPTIONS -INDEXES|
|php://filter/string.tolower/resource=.htaccess|rewriteengine on options -indexes|
|php://filter/string.strip_tags/resource=.htaccess|RewriteEngine on Options -Indexes|
|No filter applied|RewriteEngine on Options -Indexes|


## Data Wrapper
The data stream wrapper is another example of PHP's wrapper functionality. The `data://` wrapper allows inline data embedding. It is used to embed small amounts of data directly into the application code.

For example, go to [http://MACHINE_IP/playground.php](http://machine_ip/playground.php) and use the payload `data:text/plain,<?php%20phpinfo();%20?>`. In the below image, this URL could cause PHP code execution, displaying the PHP configuration details.
	![](Pasted%20image%2020250122024913.png)

The breakdown of the payload `data:text/plain,<?php phpinfo(); ?>` is:
- `data:` as the URL.
- `mime-type` is set as `text/plain`.
- The data part includes a PHP code snippet: `<?php phpinfo(); ?>`.