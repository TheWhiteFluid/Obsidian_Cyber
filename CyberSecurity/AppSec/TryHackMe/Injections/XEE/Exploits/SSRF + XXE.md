**Server-Side Request Forgery (SSRF)** attacks occur when an attacker abuses functionality on a server, causing the server to make requests to an unintended location. In the context of XXE, an attacker can manipulate XML input to make the server issue requests to internal services or access internal files. This technique can be used to scan internal networks, access restricted endpoints, or interact with services that are only accessible from the server’s local network.

## Internal Network Scanning
Consider a scenario where a vulnerable server hosts another web application internally on a non-standard port. An attacker can exploit an XXE vulnerability that makes the server send a request to its own internal network resource.

```shell
<!DOCTYPE foo [<!ELEMENT foo ANY >
<!ENTITY xxe SYSTEM "http://localhost:§10§/" >]>
<contact>
  <name>
	  &xxe;
  </name>
  <email>
	  test@test.com
  </email>
  <message>
	  test
  </message>
</contact>
```

The external entity is set to fetch data from `http://localhost:§10§/`. Intruder will then reiterate the request and search for an internal service running on the server.

### Steps to brute force for open ports:

1. ![](Pasted%20image%2020241220121311.png)
2. ![](Pasted%20image%2020241220121319.png)
3. Click the Length column to sort which item has the largest size. The difference in the server's response size is worth further investigation since it might contain information that is different compared to the other intruder requests.![](Pasted%20image%2020241220123405.png)
