The key to a successful engagement is well-coordinated planning and communication through all parties involved. This room will focus on various components of a red team engagement and planning and documenting a campaign for a red team engagement.

Red team engagements come in many varieties; including,
- Tabletop exercises 
- Adversary emulation
- Physical assessment
  
## Defining Scope and Objectives
Engagements can be categorised between a general internal/network penetration test or a focused adversary emulation. A focused adversary emulation will define a specific APT(Advanced Persistent Threat) or group to emulate within an engagement. This will typically be determined based on groups that target the company's particular industries, i.e., finance institutions and [APT38](https://web.archive.org/web/20230325143301/https://content.fireeye.com/apt/rpt-apt38). An internal or network penetration test will follow a similar structure but will often be less focused and use more standard TTPs.

The specifics of the approach will depend on a case-by-case basis of the engagement defined by the client objectives. Client objectives will also affect the engagement's general rules of engagement and scope.

The next keystone to a precise and transparent engagement is a well-defined scope. The scope of an engagement will vary by organization and what their infrastructure and posture look like. A client's scope will typically define what you cannot do or target; it can also include what you _can_ do or target. While client objectives can be discussed and determined along with the providing team, a scope should only be set by the client. In some cases the red team may discuss a grievance of the scope if it affects an engagement. They should have a clear understanding of their network and the implications of an assessment. The specifics of the scope and the wording will always look different, below is an example of what verbiage may look like within a client's scope.
- No exfiltration of data.
- Production servers are off-limits.
- 10.0.3.8/18 is out of scope.
- 10.0.0.8/20 is in scope.
- System downtime is not permitted under any circumstances.
- Exfiltration of PII is prohibited.

Below is an example of the client objectives of a mature organization with a strong security posture.

Objectives:
1. Identify system misconfigurations and network weaknesses.
    1. Focus on exterior systems.
2. Determine the effectiveness of endpoint detection and response systems.
3. Evaluate overall security posture and response.
    1. SIEM and detection measures.
    2. Remediation.
    3. Segmentation of DMZ and internal servers.
4. Use of white cards is permitted depending on downtime and length.
5. Evaluate the impact of data exposure and exfiltration.

Scope:
1. System downtime is not permitted under any circumstances.
    1. Any form of DDoS or DoS is prohibited.
    2. Use of any harmful malware is prohibited; this includes ransomware and other variations.
2. Exfiltration of PII is prohibited. Use arbitrary exfiltration data.
3. Attacks against systems within 10.0.4.0/22 are permitted.
4. Attacks against systems within 10.0.12.0/22 are prohibited.
5. Bean Enterprises will closely monitor interactions with the DMZ and critical/production systems.
    1. Any interaction with "*.bethechange.xyz" is prohibited.
    2. All interaction with "*.globalenterprises.thm" is permitted.

## Rules of Engagement
Rules of Engagement (RoE) are a legally binding outline of the client objectives and scope with further details of engagement expectations between both parties. This is the first "official" document in the engagement planning process and requires proper authorization between the client and the red team. This document often acts as the general contract between the two parties; an external contract or other NDAs (Non-Disclosure Agreement) can also be used.

Each RoE structure will be determined by the client and red team and can vary in content length and overall sections. Below is a brief table of standard sections you may see contained in the RoE.

| Section Name                          | Section Details                                                                          |
| ----------------------------------------- | -------------------------------------------------------------------------------------------- |
| Executive Summary                         | Overarching summary of all contents and authorization within RoE document                    |
| Purpose                                   | Defines why the RoE document is used                                                         |
| References                                | Any references used throughout the RoE document (HIPAA, ISO, etc.)                           |
| Scope                                     | Statement of the agreement to restrictions and guidelines                                    |
| Definitions                               | Definitions of technical terms used throughout the RoE document                              |
| Rules of Engagement and Support Agreement | Defines obligations of both parties and general technical expectations of engagement conduct |
| Provisions                                | Define exceptions and additional information from the Rules of Engagement                    |
| Requirements, Restrictions, and Authority | Define specific expectations of the red team cell                                            |
| Ground Rules                              | Define limitations of the red team cell's interactions                                       |
| Resolution of Issues/Points of Contact    | Contains all essential personnel involved in an engagement                                   |
| Authorization                             | Statement of authorization for the engagement                                                |
| Approval                                  | Signatures from both parties approving all subsections of the preceding document             |
| Appendix                                  | Any further information from preceding subsections                                           |
## Campaign Planning
Each internal red team will have its methodology and documentation for campaign planning. We will be showing one in-depth set of plans that allows for precise communication and detailed documentation. The campaign summary we will be using consists of four different plans varying in-depth and coverage adapted from military operations documents. Each plan can be found in the table below with a brief explanation.

| Type of Plan | Explanation of Plan                                                          | Plan Contents                                            |
| ---------------- | -------------------------------------------------------------------------------- | ------------------------------------------------------------ |
| Engagement Plan  | An overarching description of technical requirements of the red team.            | CONOPS, Resource and Personnel Requirements, Timelines       |
| Operations Plan  | An expansion of the Engagement Plan. Goes further into specifics of each detail. | Operators, Known Information, Responsibilities, etc.         |
| Mission Plan     | The exact commands to run and execution time of the engagement.                  | Commands to run, Time Objectives, Responsible Operator, etc. |
| Remediation Plan | Defines how the engagement will proceed after the campaign is finished.          | Report, Remediation consultation, etc.                       |
Another example of a campaign plan is the [redteam.guide](http://redteam.guide/) engagement checklist. The checklist, found [here](https://redteam.guide/docs/checklists/red-team-checklist/), acts as a more generalised approach to planning a campaign and information needed.

## Engagement Documentation
Engagement documentation is an extension of campaign planning where ideas and thoughts of campaign planning are officially documented. In this context, the term "document" can be deceiving as some plans do not require proper documentation and can be as simple as an email;.

Engagement Plan:

| Component                  | Purpose                                                                                                                                       |
| ------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------- |
| CONOPS (Concept of Operations) | Non-technically written overview of how the red team meets client objectives and target the client.                                               |
| Resource plan                  | Includes timelines and information required for the red team to be successful—any resource requirements: personnel, hardware, cloud requirements. |

Operations Plan:

| Component          | Purpose                                                 |
| ---------------------- | ----------------------------------------------------------- |
| Personnel              | Information on employee requirements.                       |
| Stopping conditions    | How and why should the red team stop during the engagement. |
| RoE (optional)         | -                                                           |
| Technical requirements | What knowledge will the red team need to be successful.     |

Mission Plan:

| Component                | Purpose                                                                                                                               |
| ---------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |
| Command playbooks (optional) | Exact commands and tools to run, including when, why, and how. Commonly seen in larger teams with many operators at varying skill levels. |
| Execution times              | Times to begin stages of engagement. Can optionally include exact times to execute tools and commands.                                    |
| Responsibilities/roles       | Who does what, when.                                                                                                                      |

Remediation Plan (optional):

| Component                | Purpose                                                                                                                                 |
| ------------------------ | --------------------------------------------------------------------------------------------------------------------------------------- |
| Report                   | Summary of engagement details and report of findings.                                                                                   |
| Remediation/consultation | How will the client remediate findings? It can be included in the report or discussed in a meeting between the client and the red team. |

## Concept of Operations
The Concept of Operation (CONOPS) is a part of the engagement plan that details a high-level overview of the proceedings of an engagement; we can compare this to an executive summary of a penetration test report. The document will serve as a business/client reference and a reference for the red cell to build off of and extend to further campaign plans.

The CONOPS document should be written from a semi-technical summary perspective, assuming the target audience/reader has zero to minimal technical knowledge. Although the CONOPS should be written at a high level, you should not omit details such as common tooling, target group, etc. As with most red team documents, there is not a set standard of a CONOPS document; below is an outline of critical components that should be included in a CONOPS.

- Client Name
- Service Provider
- Timeframe
- General Objectives/Phases
- Other Training Objectives (Exfiltration)
- High-Level Tools/Techniques planned to be used
- Threat group to emulate (if any)

## Resource Plan
Unlike the CONOPS, the resource plan should not be written as a summary; instead, written as bulleted lists of subsections. As with most red team documents, there is no standard set of resource plan templates or documents; below is an outline of example subsections of the resource plan.

- Header
    - Personnel writing
    - Dates
    - Customer
- Engagement Dates
    - Reconnaissance Dates
    - Initial Compromise Dates
    - Post-Exploitation and Persistence Dates
    - Misc. Dates
- Knowledge Required (optional)
    - Reconnaissance
    - Initial Compromise
    - Post-Exploitation
- Resource Requirements
    - Personnel
    - Hardware
    - Cloud
    - Misc.

The key to writing and understanding a resource plan is to provide enough information to gather what is required but not become overbearing. The document should be straight to the point and define what is needed.

The operations plan is a flexible document(s) that provides specific details of the engagement and actions occurring. The plan expands upon the current CONOPS and should include a majority of specific engagement information; the ROE can also be placed here depending on the depth and structure of the ROE.

The operations plan should follow a similar writing scheme to the resource plan, using bulleted lists and small sub-sections. As with the other red team documents, there is no standard set of operation plan templates or documents; below is an outline of example subsections within the operations plan.

- Header
    - Personnel writing
    - Dates
    - Customer
- Halting/stopping conditions (can be placed in ROE depending on depth)
- Required/assigned personnel
- Specific TTPs and attacks planned
- Communications plan
- Rules of Engagement (optional)

## Mission Plan
The mission plan is a cell-specific document that details the exact actions to be completed by operators. The document uses information from previous plans and assigns actions to them.

How the document is written and detailed will depend on the team; as this is an internally used document, the structure and detail have less impact. As with all the documents outlined in this room, presentation can vary; this plan can be as simple as emailing all operators. Below is a list of the minimum detail that cells should include within the plan.

- Objectives
- Operators
- Exploits/Attacks
- Targets (users/machines/objectives)
- Execution plan variations

The two plans can be thought of similarly; the operations plan should be considered from a business and client perspective, and the mission plan should be thought of from an operator and red cell perspective.