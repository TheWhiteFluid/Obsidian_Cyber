
| Attack Type       | Description                                                                | Use Case                                                  |
| ----------------- | -------------------------------------------------------------------------- | --------------------------------------------------------- |
| **Sniper**        | Iterates through a single set of payloads for one insertion point          | Testing a single parameter                                |
| **Battering Ram** | Uses the same payload for all insertion points simultaneously              | Testing the same input across multiple parameters         |
| **Pitchfork**     | Iterates through payloads in parallel for multiple insertion points        | Testing combinations of inputs across multiple parameters |
| **Cluster Bomb**  | Iterates through all possible combinations of payloads from multiple lists | Exhaustive testing of all possible payload combinations   |

| Payload Type                | Description                                                           | Use Case                                                    |
| --------------------------- | --------------------------------------------------------------------- | ----------------------------------------------------------- |
| **Simple List**             | Predefined list of payloads                                           | Testing with specific known values                          |
| **Runtime File**            | Reads payloads from a file at runtime                                 | Handling large payload lists                                |
| **Numbers**                 | Generates numeric payloads                                            | Brute force on numeric parameters                           |
| **Dates**                   | Generates date payloads                                               | Testing date-based parameters                               |
| **Brute Forcer**            | Iterates through characters to create strings                         | Brute-forcing passwords or discovering hidden resources     |
| **Character Substitutions** | Substitutes characters in a base string according to rules            | Testing input validation and escaping vulnerabilities       |
| **Illegal Unicode**         | Generates payloads with illegal Unicode characters                    | Testing handling of invalid Unicode input                   |
| **Custom Iterator**         | Defines custom iterators for complex payload generation               | Generating complex payloads requiring specific combinations |
| **Extension-generated**     | Uses Burp extensions for payload generation                           | Customized payload generation                               |
| **Markov Chains**           | Generates payloads based on statistical models of character sequences | Generating realistic payloads based on observed patterns    |
## Attack Types
Burp Suite's Intruder tool supports several attack types, each designed for specific testing scenarios. Here’s a detailed explanation of each attack type:
### 1. **Sniper**
- **Description:** This is the simplest attack type, where Burp iterates through a single set of payloads, inserting each one at a single insertion point.
- **Use Case:** Useful for testing a single parameter or insertion point to see how different values affect the response.

### 2. **Battering Ram**
- **Description:** This attack type uses the same payload for all insertion points simultaneously. It iterates through the payload list and applies the same payload to every marked position.
- **Use Case:** Suitable for testing scenarios where the same input needs to be tested across multiple parameters, such as testing for reflected values in multiple places.

### 3. **Pitchfork**
- **Description:** In this type, each insertion point gets its own list of payloads, and Burp iterates through the payloads in parallel. It inserts the first payload from each list into the corresponding insertion point, then the second payload from each list, and so on.
- **Use Case:** Useful when you want to test combinations of inputs across multiple parameters. For example, testing pairs of usernames and passwords.

### 4. **Cluster Bomb**
- **Description:** This attack type is more complex, where Burp iterates through every possible combination of payloads from multiple lists. It inserts each combination into the corresponding insertion points.
- **Use Case:** Ideal for exhaustive testing of all possible payload combinations across multiple parameters, such as finding vulnerabilities that depend on specific parameter combinations.

| Attack Type       | Description                                                                | Use Case                                                  |
| ----------------- | -------------------------------------------------------------------------- | --------------------------------------------------------- |
| **Sniper**        | Iterates through a single set of payloads for one insertion point          | Testing a single parameter                                |
| **Battering Ram** | Uses the same payload for all insertion points simultaneously              | Testing the same input across multiple parameters         |
| **Pitchfork**     | Iterates through payloads in parallel for multiple insertion points        | Testing combinations of inputs across multiple parameters |
| **Cluster Bomb**  | Iterates through all possible combinations of payloads from multiple lists | Exhaustive testing of all possible payload combinations   |

## Payload Types
Burp Suite's Intruder tool offers several payload types, each designed for different kinds of automated attacks. Here’s a detailed explanation of each payload type:

### 1. **Simple List**
- **Description:** Allows you to provide a predefined list of payloads. You can either manually enter each payload or load them from a file.
- **Use Case:** Useful for testing with a specific set of known values, such as a list of usernames, passwords, or common SQL injection strings.

### 2. **Runtime File**
- **Description:** Reads payloads from a file at runtime. Each time an attack is executed, Burp reads the next payload from the specified file.
- **Use Case:** Ideal when dealing with very large lists of payloads that are impractical to load entirely into memory.

### 3. **Numbers**
- **Description:** Generates payloads based on a range of numbers. You can specify the start, end, and step values.
- **Use Case:** Useful for brute force attacks on numeric parameters, such as iterating through user IDs.

### 4. **Dates**
- **Description:** Generates payloads based on date ranges. You can specify the start date, end date, and the format of the dates.
- **Use Case:** Useful for testing date-based parameters, such as searching for events within a certain date range.

### 5. **Brute Forcer**
- **Description:** Generates payloads by iterating through a set of characters to create strings of increasing length.
- **Use Case:** Ideal for brute-forcing passwords or discovering hidden resources with predictable naming conventions.

### 6. **Character Substitutions**
- **Description:** Generates payloads by substituting characters in a base payload string according to a set of substitution rules.
- **Use Case:** Useful for testing input validation and escaping vulnerabilities, such as SQL injection or XSS.

### 7. **Illegal Unicode**
- **Description:** Generates payloads containing illegal Unicode characters.
- **Use Case:** Useful for testing how applications handle invalid Unicode input, which can lead to vulnerabilities like buffer overflow or improper input handling.

### 8. **Custom Iterator**
- **Description:** Allows you to define custom iterators to generate complex payloads. You can specify multiple iterators and their sequences.
- **Use Case:** Useful for generating payloads that require a specific combination of inputs.

### 9. **Extension-generated**
- **Description:** Generates payloads using Burp Suite extensions. These can be written in Java or Python using the Burp Extender API.
- **Use Case:** Useful for highly customized payload generation, tailored to specific testing needs that aren't covered by the default options.

### 10. **Markov Chains**
- **Description:** Generates payloads based on statistical models of character sequences. It uses a seed list to learn typical sequences and generate similar payloads.
- **Use Case:** Useful for generating realistic payloads based on observed patterns, such as usernames or paths.

| Payload Type                | Description                                                           | Use Case                                                    |
| --------------------------- | --------------------------------------------------------------------- | ----------------------------------------------------------- |
| **Simple List**             | Predefined list of payloads                                           | Testing with specific known values                          |
| **Runtime File**            | Reads payloads from a file at runtime                                 | Handling large payload lists                                |
| **Numbers**                 | Generates numeric payloads                                            | Brute force on numeric parameters                           |
| **Dates**                   | Generates date payloads                                               | Testing date-based parameters                               |
| **Brute Forcer**            | Iterates through characters to create strings                         | Brute-forcing passwords or discovering hidden resources     |
| **Character Substitutions** | Substitutes characters in a base string according to rules            | Testing input validation and escaping vulnerabilities       |
| **Illegal Unicode**         | Generates payloads with illegal Unicode characters                    | Testing handling of invalid Unicode input                   |
| **Custom Iterator**         | Defines custom iterators for complex payload generation               | Generating complex payloads requiring specific combinations |
| **Extension-generated**     | Uses Burp extensions for payload generation                           | Customized payload generation                               |
| **Markov Chains**           | Generates payloads based on statistical models of character sequences | Generating realistic payloads based on observed patterns    |

## Example Walkthrough

1. Navigate to `http://MACHINE_IP/admin/login/`. Activate **Intercept** in the Proxy module and attempt to log in. Capture the request and send it to Intruder.
2. Configure the positions the same way as we did for brute-forcing the support login:
    - Set the attack type to "Pitchfork".
    - Clear all predefined positions and select only the username and password form fields. Our macro will handle the other two positions.
- ![[Pasted image 20240619005804.png]]
3. Now switch over to the Payloads tab and load in the same username and password wordlists we used for the support login attack.
    Up until this point, we have configured Intruder in almost the same way as our previous credential stuffing attack; this is where things start to get more complicated.
    
4. With the username and password parameters handled, we now need to find a way to grab the ever-changing loginToken and session cookie. Unfortunately, "recursive grep" won't work here due to the redirect response, so we can't do this entirely within Intruder – we will need to build a macro.
    Macros allow us to perform the same set of actions repeatedly. In this case, we simply want to send a GET request to `/admin/login/`.
	- Switch over to the main "Settings" tab at the top-right of Burp.
	- Click on the "Sessions" category.
	- Scroll down to the bottom of the category to the "Macros" section and click the **Add** button.
	- The menu that appears will show us our request history. If there isn't a GET request to `http://MACHINE_IP/admin/login/` in the list already, navigate to this location in your browser, and you should see a suitable request appear in the list.
	- With the request selected, click **OK**.
	- Finally, give the macro a suitable name, then click **OK** again to finish the process.

![[Screen Recording 2024-06-19 at 01.03.47.mov]]

5. Now that we have a macro defined, we need to set Session Handling rules that define how the macro should be used.
	- Still in the "Sessions" category of the main settings, scroll up to the "Session Handling Rules" section and choose to **Add** a new rule.
	- A new window will pop up with two tabs in it: "Details" and "Scope". We are in the Details tab by default.
	![[Pasted image 20240619011008.png]]
	
	- Fill in an appropriate description, then switch to the Scope tab.
	- In the "Tools Scope" section, deselect every checkbox other than Intruder – we do not need this rule to apply anywhere else.
	- In the "URL Scope" section, choose "Use suite scope"; this will set the macro to only operate on sites that have been added to the global scope (as was discussed in [Burp Basics](https://tryhackme.com/room/burpsuitebasics)). If you have not set a global scope, keep the "Use custom scope" option as default and add `http://MACHINE_IP/` to the scope in this section
		 ![[Pasted image 20240619011108.png]]

6. Now we need to switch back over to the Details tab and look at the "Rule Actions" section.
	- Click the **Add** button – this will cause a dropdown menu to appear with a list of actions we can add.
	- Select "Run a Macro" from this list.
	- In the new window that appears, select the macro we created earlier.
	    
	As it stands, this macro will now overwrite all of the parameters in our Intruder requests before we send them; this is great, as it means that we will get the loginTokens and session cookies added straight into our requests. That said, we should restrict which parameters and cookies are being updated before we start our attack:
	- Select "Update only the following parameters and headers", then click the **Edit** button next to the input box below the radio button.
	- In the "Enter a new item" text field, type "loginToken". Press **Add**, then **Close**.
	- Select "Update only the following cookies", then click the relevant **Edit** button.
	- Enter "session" in the "Enter a new item" text field. Press **Add**, then **Close**.
	- Finally, press **OK** to confirm our action.
	![[Screen Recording 2024-06-19 at 01.12.01.mov]]
You should now have a macro defined that will substitute in the CSRF token and session cookie. All that's left to do is switch back to Intruder and start the attack!
    
**Note:** You should be getting 302 status code responses for every request in this attack. If you see 403 errors, then your macro is not working properly.
    
 As with the support login credential stuffing attack we carried out, the response codes here are all the same (302 Redirects). Once again, order your responses by length to find the valid credentials. Your results won't be quite as clear-cut as last time – you will see quite a few different response lengths: however, the response that indicates a successful login should still stand out as being significantly shorter.