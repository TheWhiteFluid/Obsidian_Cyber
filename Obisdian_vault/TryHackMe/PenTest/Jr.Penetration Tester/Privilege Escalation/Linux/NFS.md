Privilege escalation vectors are not confined to internal access. Shared folders and remote management interfaces such as SSH and Telnet can also help you gain root access on the target system. Some cases will also require using both vectors, e.g. finding a root SSH private key on the target system and connecting via SSH with root privileges instead of trying to increase your current user’s privilege level.

NFS (Network File Sharing) configuration is kept in the `/etc/exports` file. This file is created during the NFS server installation and can usually be read by users.
	![[Pasted image 20240825201119.png]]
The critical element for this privilege escalation vector is the `“no_root_squash`” option you can see above. By default, NFS will change the root user to nfsnobody and strip any file from operating with root privileges. If the “`no_root_squash`” option is present on a writable share, we can create an executable with SUID bit set and run it on the target system.

We will start by enumerating mountable shares from our attacking machine.
	![](https://i.imgur.com/CmXPDcv.png)

We will mount one of the “`no_root_squash`” shares to our attacking machine and start building our executable.
	![](https://i.imgur.com/DwAB1qs.png)
As we can set SUID bits, a simple executable that will run `/bin/bash` on the target system will do the job.
	![[Pasted image 20240825223435.png]]
Once we compile the code we will set the SUID bit
	![[Pasted image 20240825223511.png]]
You will see below that both files (nfs.c and nfs are present on the target system. We have worked on the mounted share so there was no need to transfer them). Notice the nfs executable has the SUID bit set on the target system and runs with root privileges.
	![[Pasted image 20240825223538.png]]

## **Examples**
Q)How many mountable shares can you identify on the target system?
	![[Pasted image 20240825230634.png]]
Q)How many shares have the "no_root_squash" option enabled?
	![[Pasted image 20240825230536.png]]
Q)Gain a root shell on the target system
	- using our attaching machine -> display mountable directories of the target machine 
	- create a temporary directory named temp in /tmp
	- mount one of the no_root_squash directory on our machine inside of /tmp/temp directory
	- create a payload(/bin/bash reverse shell in C) that will be distributed trough NFS 
	- set SUID bit permission to the payload file from our attacking machine
	- run payload on the target machine --> root acces
	![[Pasted image 20240825231102.png]]![[Pasted image 20240825231856.png]]![[Pasted image 20240825231822.png]]![[Pasted image 20240825231922.png]]