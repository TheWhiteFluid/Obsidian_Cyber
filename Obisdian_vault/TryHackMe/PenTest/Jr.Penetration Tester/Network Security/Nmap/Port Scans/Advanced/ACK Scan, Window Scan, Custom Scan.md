
## ACK Scan
As the name implies, an ACK scan will send a TCP packet with the ACK flag set. The target would respond with RST regardless of the state of the port. This behaviour happens because a TCP packet with the ACK flag set should be sent only in response to a received TCP packet to acknowledge the receipt of some data, unlike our case. 

This scan won’t tell us whether the target port is open in a simple setup.
	![[Pasted image 20240730045416.png]]
Use the `-sA` option to choose this scan:
	![[Pasted image 20240730045430.png]]

This kind of scan would be helpful if there is a firewall in front of the target. Consequently, based on which ACK packets resulted in responses, you will learn which ports were not blocked by the firewall. 

*Note:*
	This type of scan is more suitable to discover firewall rule sets and configuration.

After setting up the target VM  with a firewall, we repeated the ACK scan. As seen in the console output below, we have three ports that aren't being blocked by the firewall. This result indicates that the firewall is blocking all other ports except for these three ports.
	![[Pasted image 20240730050819.png]]

## Window Scan
Another similar scan is the TCP window scan. The TCP window scan is almost the same as the ACK scan; however, it examines the TCP Window field of the RST packets returned.
	![[Pasted image 20240730050953.png]]

Similarly, launching a TCP window scan against a Linux system with no firewall will not provide much information. As we can see in the console output below, the results of the window scan against a Linux server with no firewall didn’t give any extra information compared to the ACK scan executed earlier.

You can select this scan type with the option `-sW`:
	![[Pasted image 20240730051024.png]]

If we repeat our TCP window scan against a server behind a firewall, we expect to get more satisfying results. In the console output shown below, the TCP window scan pointed that three ports are detected as closed. (This is in contrast with the ACK scan that labelled the same three ports as unfiltered.) 

Although we know that these three ports are not closed, we realise they responded differently, indicating that the firewall does not block them.
	![[Pasted image 20240730051206.png]]

## Custom Scan
If you want to experiment with a new TCP flag combination beyond the built-in TCP scan types, you can do so using `--scanflags`

 For instance, if you want to set `SYN`, `RST`, and `FIN` simultaneously, you can do so using
  `--scanflags RSTSYNFIN`
	  ![[Pasted image 20240730051458.png]]
*Note:*
	 It is essential to note that the ACK scan and the window scan were very efficient at helping us map out the firewall rules. However, it is vital to remember that just because a firewall is not blocking a specific port, it does not necessarily mean that a service is listening on that port.  (*there is a possibility that the firewall rules need to be updated to reflect recent service changes. Hence, ACK and window scans are exposing the firewall rules, not the services.*)