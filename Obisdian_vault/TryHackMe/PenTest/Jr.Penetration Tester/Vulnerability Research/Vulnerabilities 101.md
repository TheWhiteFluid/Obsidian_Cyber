- What vulnerabilities are;
- Why they're worthy of learning about;
- How are vulnerabilities rated;
- Databases for vulnerability research;
- A showcase of how vulnerability research is used on ACKme's engagement.

## **Introduction to Vulnerabilities**
A vulnerability in cybersecurity is defined as a weakness or flaw in the design, implementation or behaviours of a system or application. An attacker can exploit these weaknesses to gain access to unauthorised information or perform unauthorised actions. The term “vulnerability” has many definitions by cybersecurity bodies. However, there is minimal variation between them all.

For example, NIST defines a vulnerability as “weakness in an information system, system security procedures, internal controls, or implementation that could be exploited or triggered by a threat source”.

Vulnerabilities can originate from many factors, including a poor design of an application or an oversight of the intended actions from a user.

| **Vulnerability**           | **Description**                                                                                                                                                                                                                                    |
| --------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Operating System            | These types of vulnerabilities are found within Operating Systems (OSs) and often result in privilege escalation.                                                                                                                                  |
| (Mis)Configuration-based    | These types of vulnerability stem from an incorrectly configured application or service. For example, a website exposing customer details.                                                                                                         |
| Weak or Default Credentials | Applications and services that have an element of authentication will come with default credentials when installed. For example, an administrator dashboard may have the username and password of "admin". These are easy to guess by an attacker. |
| Application Logic           | These vulnerabilities are a result of poorly designed applications. For example, poorly implemented authentication mechanisms that may result in an attacker being able to impersonate a user.                                                     |
| Human-Factor                | Human-Factor vulnerabilities are vulnerabilities that leverage human behaviour. For example, phishing emails are designed to trick humans into believing they are legitimate.                                                                      |

## **Scoring Vulnerabilities (CVSS & VPR)**
Vulnerability management is the process of evaluating, categorising and ultimately remediating threats (vulnerabilities) faced by an organisation.

Approximately 2% of vulnerabilities only ever end up being exploited ([Kenna security., 2020](https://www.kennasecurity.com/resources/prioritization-to-prediction-report/)). Instead, it is all about addressing the most dangerous vulnerabilities and reducing the likelihood of an attack vector being used to exploit a system.

This is where vulnerability scoring comes into play. Vulnerability scoring serves a vital role in vulnerability management and is used to determine the potential risk and impact a vulnerability may have on a network or computer system. For example, the popular Common Vulnerability Scoring System (CVSS) awards points to a vulnerability based upon its features, availability, and reproducibility.
### Common Vulnerability Scoring System(CVSS)
First introduced in 2005, the Common Vulnerability Scoring System (or CVSS) is a very popular framework for vulnerability scoring and has three major iterations. As it stands, the current version is CVSSv3.1 (with version 4.0 currently in draft) a score is essentially determined by some of the following factors (but many more):
  1. How easy is it to exploit the vulnerability?
  2. Do exploits exist for this?
  3. How does this vulnerability interfere with the CIA triad?

|            |            |
| ---------- | ---------- |
| **Rating** | **Score**  |
| None       | 0          |
| Low        | 0.1 - 3.9  |
| Medium     | 4.0 - 6.9  |
| High       | 7.0 - 8.9  |
| Critical   | 9.0 - 10.0 |

| **Advantages of CVSS**                                                           | **Disadvantages of CVSS**                                                                                                                                                                      |
| -------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| CVSS has been around for a long time.                                            | CVSS was never designed to help prioritise vulnerabilities, instead, just assign a value of severity.                                                                                          |
| CVSS is popular in organisations.                                                | CVSS heavily assesses vulnerabilities on an exploit being available. However, only 20% of all vulnerabilities have an exploit available ([Tenable., 2020](https://www.tenable.com/research)) . |
| CVSS is a free framework to adopt and recommended by organisations such as NIST. | Vulnerabilities rarely change scoring after assessment despite the fact that new developments such as exploits may be found.                                                                   |

### Vulnerability Priority Rating (VPR)
The VPR framework is a much more modern framework in vulnerability management - developed by Tenable, an industry solutions provider for vulnerability management. This framework is considered to be risk-driven; meaning that vulnerabilities are given a score with a heavy focus on the risk a vulnerability poses to the organisation itself, rather than factors such as impact (like with CVSS).

Unlike CVSS, VPR scoring takes into account the relevancy of a vulnerability. For example, no risk is considered regarding a vulnerability if that vulnerability does not apply to the organisation (i.e. they do not use the software that is vulnerable). VPR is also considerably dynamic in its scoring, where the risk that a vulnerability may pose can change almost daily as it ages.

VPR uses a similar scoring range as CVSS. However, two notable differences are that VPR does not have a _"None/Informational"_ category, and because VPR uses a different scoring method, the same vulnerability will have a different score using VPR than when using CVSS.

|            |            |
| ---------- | ---------- |
| **Rating** | **Score**  |
| Low        | 0.0 - 3.9  |
| Medium     | 4.0 - 6.9  |
| High       | 7.0 - 8.9  |
| Critical   | 9.0 - 10.0 |

| **Advantages of VPR**                                                                                                                   | **Disadvantages of VPR**                                                                                                                                                                                               |
| --------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| VPR is a modern framework that is real-world.                                                                                           | VPR is not open-source like some other vulnerability management frameworks.                                                                                                                                            |
| VPR considers over 150 factors when calculating risk.                                                                                   | VPR can only be adopted apart of a commercial platform.                                                                                                                                                                |
| VPR is risk-driven and used by organisations to help prioritise patching vulnerabilities.                                               | VPR does not consider the CIA triad to the extent that CVSS does; meaning that risk to the confidentiality, integrity and availability of data does not play a large factor in scoring vulnerabilities when using VPR. |
| Scorings are not final and are very dynamic, meaning the priority a vulnerability should be given can change as the vulnerability ages. | _Intentionally left blank._                                                                                                                                                                                            |

## **Vulnerability Databases**
1. [NVD (National Vulnerability Database)](https://nvd.nist.gov/vuln)
2. [Exploit-DB](http://exploit-db.com/)

| **Term**               | **Definition**                                                                                                           |
| ---------------------- | ------------------------------------------------------------------------------------------------------------------------ |
| Vulnerability          | A vulnerability is defined as a weakness or flaw in the design, implementation or behaviours of a system or application. |
| Exploit                | An exploit is something such as an action or behaviour that utilises a vulnerability on a system or application.         |
| Proof of Concept (PoC) | A PoC is a technique or tool that often demonstrates the exploitation of a vulnerability.                                |
|                        |                                                                                                                          |

### #NVD – National Vulnerability Database
The National Vulnerability Database is a website that lists all publically categorised vulnerabilities. In cybersecurity, vulnerabilities are classified under “**C**ommon **V**ulnerabilities and **E**xposures” (Or CVE for short).

These CVEs have the formatting of `CVE-YEAR-IDNUMBER`. For example, the vulnerability that the famous malware WannaCry used was `CVE-2017-0144.`

![[Pasted image 20240805155329.png]]

Note:
	While this website helps keep track of new vulnerabilities, it is not great when searching for vulnerabilities for a specific application or scenario.

### #Exploit-DB
[Exploit-DB](https://www.exploit-db.com/) is a resource that we, as hackers, will find much more helpful during an assessment. Exploit-DB retains exploits for software and applications stored under the name, author and version of the software or application.

We can use Exploit-DB to look for snippets of code (known as Proof of Concepts) that are used to exploit a specific vulnerability.
![[Pasted image 20240805155842.png]]


## **Example: Finding a Vulnerability**
Throughout an assessment, you will often combine multiple vulnerabilities to get results. For example, in this task, we will leverage the “**Version Disclosure”** vulnerability to find out the version of an application. With this version, we can then use [Exploit-DB](https://www.exploit-db.com/) to search for any exploits that work with that specific version.

Applications and software usually have a version number. This information is usually left with good intentions; for example, the author can support multiple versions of the software and the likes. Or sometimes, left unintentionally. For example, in the screenshot below, we can see that the name and version number of this application is “**Apache Tomcat 9.0.17**”
![[Pasted image 20240805160914.png]]

With this information in hand, let’s use the search filter on Exploit-DB to look for any exploits that may apply to “**Apache Tomcat 9.0.17**”. After searching Exploit-DB, there are a total of five exploits that may be useful to us for this specific version of the application.
![[Pasted image 20240805161038.png]]

## **Showcase**: **Exploiting Ackme's Application**
As we can see, ACKme IT Services provide IT services to 800+ clients. This information is useful because we can begin to think of possible software that they are using for us to attack. For example, helpdesk or a support application.

- We move on to the enumeration and scanning stage of the engagement. This stage helps establish services and applications running on ACKme's infrastructure.   
- We can use the information gathered from this scan to begin to understand what services may be viable to attack. For example, a webserver hosting a website.  
  
Recall from our Email, we are given one IP address **240.228.189.136.**
```
user@thepentestingco:~$ nmap 240.228.189.136  
  
Starting Nmap 7.60 ( https://nmap.org )

Nmap scan report for 240.228.189.136  
Host is up (0.0013s latency).  
Not shown: 997 closed ports  
PORT STATE SERVICE  
22/tcp open ssh  
80/tcp open http  
443/tcp open https  
  
Nmap done: 1 IP address (1 host up) scanned in 8.35 seconds

user@thepentestingco:~$ nmap
```

- Using the information gathered from stage two of the penetration engagement we have visited the target in their web browser and has been greeted with a login page.   
- The Sr. Penetration tester guesses some random passwords such as 'admin' and 'admin' to no avail. We notice a version number of the application **1.5.2** and takes a note of this. This will be useful for the next stage.
- The Sr. Penetration tester recalls that ACKme IT Services uses an application called ACKme Portal that has a version number of 1.5.2. The Sr. Penetration Tester visits a vulnerability & exploit database called 'Vulnerability Bank™'. There is one vulnerability listed for that application & version: Remote Code Execution (RCE).
- RCE vulnerability allows commands to be executed on the target's system. The Sr. Penetration Tester could use this vulnerability to gain access to the console of the target. Try searching Vulnerability Bank™️ for an exploit for **ACKMe Portal 1.5.2**
- Accumulating the information from all the previous stages, the Sr. Penetration Tester uses the exploit downloaded from Vulnerability Bank™️ against ACKme's web application on 240.228.189.13.
- The exploit is successful and abuses the Remote Code Execution (RCE) vulnerability to launch a reverse shell on ACKme's infrastructure.
```
user@thepentestingco:~$ run exploit -u http://240.228.189.136

Running exploit!

Exploit complete! Launching shell...

administrator@ackmeitservices:~$ whoami

ACKME\Administrator
```
